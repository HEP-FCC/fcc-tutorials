<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.1. FCC: Getting started with event generation &mdash; FCC Tutorials  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom-admonitions.css?v=e6bfab01" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2. FCC: Getting started with simulating events in Delphes" href="k4simdelphes/doc/starterkit/FccFastSimDelphes/Readme.html" />
    <link rel="prev" title="2. Generators, Fast Simulation and Analysis" href="README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            FCC Tutorials
              <img src="../_static/fcc-logo-light.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../software-basics/README.html">1. First  Steps</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="README.html">2. Generators, Fast Simulation and Analysis</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.1. FCC: Getting started with event generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">2.1.1. Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabling-fccsw">2.1.2. Enabling FCCSW</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generators">2.1.3. Generators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">2.1.3.1. Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pythia8">2.1.3.2. Pythia8</a></li>
<li class="toctree-l4"><a class="reference internal" href="#whizard">2.1.3.3. Whizard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#madgraph5">2.1.3.4. MadGraph5</a></li>
<li class="toctree-l4"><a class="reference internal" href="#herwig">2.1.3.5. Herwig</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kkmcee">2.1.3.6. KKMCee</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bhlumi">2.1.3.7. BHLUMI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#babayaga">2.1.3.8. BabaYaga</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hands-on-case-study-ditau-events-with-kkmcee-pythia8-and-whizard">2.1.4. Hands-on case study: ditau events with KKMCee, Pythia8 and Whizard</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generating-ditaus-with-kkmcee">2.1.4.1. Generating ditaus with KKMCee</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generating-ditaus-with-pythia8">2.1.4.2. Generating ditaus with Pythia8</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generating-ditaus-with-whizard">2.1.4.3. Generating ditaus with Whizard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#looking-at-the-produced-files-the-mcparticle-class">2.1.4.4. Looking at the produced files: the MCParticle class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="k4simdelphes/doc/starterkit/FccFastSimDelphes/Readme.html">2.2. FCC: Getting started with simulating events in Delphes</a></li>
<li class="toctree-l2"><a class="reference internal" href="fccanalyses/doc/starterkit/FccFastSimAnalysis/Readme.html">2.3. FCC: Getting started with analysing simulated events</a></li>
<li class="toctree-l2"><a class="reference internal" href="fccanalyses/doc/starterkit/FccFastSimVertexing/Readme.html">2.4. FCC: tracking and vertexing example using specific flavour decays</a></li>
<li class="toctree-l2"><a class="reference internal" href="FCCAnalysesProblemsAndSolutions.html">2.5. FCCAnalyses: Common problems and solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="EventProduction.html">2.6. Central production of events</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../full-detector-simulations/README.html">3. Full Detector Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distributed-computing/README.html">4. Distributed computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developing-fcc-software/README.html">5. Developing FCCSW</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">6. Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://hep-fcc.github.io/FCCSW/">FCCSW main page</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hep-fcc.github.io/FCCAnalyses/doc/latest/index.html">FCCAnalyses reference documentation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hsf-training.github.io/analysis-essentials/">Analysis essentials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hep-fcc.github.io/glossary">FCC software glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FCC Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="README.html"><span class="section-number">2. </span>Generators, Fast Simulation and Analysis</a></li>
      <li class="breadcrumb-item active"><span class="section-number">2.1. </span>FCC: Getting started with event generation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/HEP-FCC/fcc-tutorials/blob/main/fast-sim-and-analysis/FccFastSimGeneration.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="fcc-getting-started-with-event-generation">
<h1><span class="section-number">2.1. </span>FCC: Getting started with event generation<a class="headerlink" href="#fcc-getting-started-with-event-generation" title="Link to this heading"></a></h1>
<section id="overview">
<h2><span class="section-number">2.1.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
</section>
<section id="enabling-fccsw">
<h2><span class="section-number">2.1.2. </span>Enabling FCCSW<a class="headerlink" href="#enabling-fccsw" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>To configure your environment for the FCC software, just do:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">key4hep</span><span class="o">/</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<div class="callout admonition">
<p class="admonition-title">Nota Bene</p>
<p>For legacy reasons the following is still provided, fully equivalent to the above</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">fcc</span><span class="o">.</span><span class="n">cern</span><span class="o">.</span><span class="n">ch</span><span class="o">/</span><span class="n">sw</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<p>Builds exist on CernVM-FS for CentOS7 (this is the Operating System run on <code class="docutils literal notranslate"><span class="pre">lxplus</span></code>) using gcc11.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">k4run</span></code> steering application should be available at this point:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>which<span class="w"> </span>k4run
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># The output might differ, but shouldn&#39;t be empty and the structure should be similar</span>
<span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">spackages6</span><span class="o">/</span><span class="n">k4fwcore</span><span class="o">/</span><span class="mf">1.0</span><span class="n">pre15</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">centos7</span><span class="o">-</span><span class="n">gcc11</span><span class="mf">.2.0</span><span class="o">-</span><span class="n">opt</span><span class="o">/</span><span class="mi">2</span><span class="n">q37t</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">k4run</span>
</pre></div>
</div>
<p>The application <code class="docutils literal notranslate"><span class="pre">fccrun</span></code> is still provided, fully equivalent to <code class="docutils literal notranslate"><span class="pre">k4run</span></code>.</p>
<div class="callout admonition">
<p class="admonition-title">Nota Bene</p>
<p>You will need to source the <code class="docutils literal notranslate"><span class="pre">/cvmfs/sw.hsf.org/key4hep/setup.sh</span></code> script everytime you want to use the software.</p>
</div>
</section>
<section id="generators">
<h2><span class="section-number">2.1.3. </span>Generators<a class="headerlink" href="#generators" title="Link to this heading"></a></h2>
<section id="id1">
<h3><span class="section-number">2.1.3.1. </span>Overview<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>The physics generators available for FCC typically come from the underlying stack. However, any generator
able to generate events in one of the understood formats, e.g. HepMC or EDM4hep or LHEf, can be used in standalone.
The recommended formats are <code class="docutils literal notranslate"><span class="pre">HepMC3</span></code> and <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code>.
This pages intend to illustrate the use of a few general purpose generators available when enabling FCCSW:
pythia8, whizard, MadGraph5, Herwig, KKMCee, BHLUMI, BabaYaga.</p>
</section>
<section id="pythia8">
<h3><span class="section-number">2.1.3.2. </span>Pythia8<a class="headerlink" href="#pythia8" title="Link to this heading"></a></h3>
<p>Pythia8 is fully intergrated in <code class="docutils literal notranslate"><span class="pre">Key4hep</span></code> software stack and it provides diverse functionality in addition to event generation,
including capability to read events in LHEF format.</p>
<p>To use Pythia8 we need a Gaudi steering file and a configuration file. Examples of configuration files can be obtained from the <a class="reference external" href="https://github.com/HEP-FCC/FCC-config/tree/main/FCCee/Generator/Pythia8">FCC-config</a> repository.</p>
<p>The Gaudi steering file needs to activate the <code class="docutils literal notranslate"><span class="pre">GaudiAlgorithm</span></code> that runs Pythia8; the algorithm is available from the <code class="docutils literal notranslate"><span class="pre">k4Gen</span></code> repository and it is called <a class="reference external" href="https://github.com/HEP-FCC/k4Gen/blob/main/k4Gen/src/components/PythiaInterface.h">PythiaInterface</a>.</p>
<p>An example of steering file can be found at <a class="reference external" href="https://github.com/HEP-FCC/k4Gen/blob/main/k4Gen/options/pythia.py">https://github.com/HEP-FCC/k4Gen/blob/main/k4Gen/options/pythia.py</a>. The steering file runs the miniaml set of algorithms to run Pythia8 and produce an output in <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://raw.githubusercontent.com/HEP-FCC/k4Gen/main/k4Gen/options/pythia.py
$ k4run pythia.py -h
 --&gt;  Pythia8 --&gt;  HepMCToEDMConverter --&gt;  StableParticles --&gt;  out
...
  -n NUM_EVENTS, --num-events NUM_EVENTS
                        Number of events to run
...
  --out.filename [OUT.FILENAME], --filename.out [OUT.FILENAME]
                        Name of the file to create [PodioOutput]
...
  --Pythia8.PythiaInterface.pythiacard [PYTHIA8.PYTHIAINTERFACE.PYTHIACARD], --pythiacard.Pythia8.PythiaInterface [PYTHIA8.PYTHIAINTERFACE.PYTHIACARD]
                        [PythiaInterface]
...

</pre></div>
</div>
<p>For example, to generate 500  e<sup>+</sup>e<sup>-</sup> → mu<sup>+</sup>mu<sup>-</sup> at 91.2 GeV, we can do the following: download the configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://raw.githubusercontent.com/HEP-FCC/FCC-config/main/FCCee/Generator/Pythia8/p8_ee_Zmumu_ecm91.cmd
</pre></div>
</div>
<p>and run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k4run</span> <span class="n">pythia</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="mi">500</span> <span class="o">--</span><span class="n">out</span><span class="o">.</span><span class="n">filename</span> <span class="n">p8_mumu_500</span><span class="o">.</span><span class="n">e4h</span><span class="o">.</span><span class="n">root</span> <span class="o">--</span><span class="n">Pythia8</span><span class="o">.</span><span class="n">PythiaInterface</span><span class="o">.</span><span class="n">pythiacard</span> <span class="n">p8_ee_Zmumu_ecm91</span><span class="o">.</span><span class="n">cmd</span>
</pre></div>
</div>
</section>
<section id="whizard">
<h3><span class="section-number">2.1.3.3. </span>Whizard<a class="headerlink" href="#whizard" title="Link to this heading"></a></h3>
<p>Whizard is available as standalone program:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>which<span class="w"> </span>whizard
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">spackages6</span><span class="o">/</span><span class="n">whizard</span><span class="o">/</span><span class="mf">3.0.1</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">centos7</span><span class="o">-</span><span class="n">gcc11</span><span class="mf">.2.0</span><span class="o">-</span><span class="n">opt</span><span class="o">/</span><span class="n">pmm4s</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">whizard</span>
</pre></div>
</div>
<p>Whizard is run as this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">whizard</span> <span class="o">&lt;</span><span class="n">process_config</span><span class="o">&gt;.</span><span class="n">sin</span>
</pre></div>
</div>
<p>Example of process configuration files are found under</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ls<span class="w"> </span>/cvmfs/sw.hsf.org/spackages6/whizard/3.0.1/x86_64-centos7-gcc11.2.0-opt/pmm4s/share/whizard/examples/
</pre></div>
</div>
<p>or at <code class="docutils literal notranslate"><span class="pre">https://gitlab.tp.nt.uni-siegen.de/whizard/public/-/tree/master/share/examples</span></code> .</p>
<p>Some examples more specific to FCC can be found under</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">/</span><span class="n">eos</span><span class="o">/</span><span class="n">project</span><span class="o">-</span><span class="n">f</span><span class="o">/</span><span class="n">fccsw</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">gen</span><span class="o">/</span><span class="n">whizard</span><span class="o">/</span>
</pre></div>
</div>
<p>or browsing <code class="docutils literal notranslate"><span class="pre">https://fccsw.web.cern.ch/fccsw/share/gen/whizard/Zpole/</span></code>, if EOS is not available.</p>
<div class="toggle admonition">
<p class="admonition-title">Show dimuon example</p>
<p>It is advised to work in a separate directory for each process. For example, for Z_mumu, we have:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>test_whizard/Z_mumu<span class="p">;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>test_whizard/Z_mumu
<span class="w"> </span>wget<span class="w"> </span>https://fccsw.web.cern.ch/fccsw/share/gen/whizard/Zpole/Z_mumu.sin
<span class="w"> </span>whizard<span class="w"> </span>Z_mumu.sin
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>| Writing log to &#39;whizard.log&#39;
|=============================================================================|
|                                                                             |
|    WW             WW  WW   WW  WW  WWWWWW      WW      WWWWW    WWWW        |
|     WW    WW     WW   WW   WW  WW     WW      WWWW     WW  WW   WW  WW      |
|      WW  WW WW  WW    WWWWWWW  WW    WW      WW  WW    WWWWW    WW   WW     |
|       WWWW   WWWW     WW   WW  WW   WW      WWWWWWWW   WW  WW   WW  WW      |
|        WW     WW      WW   WW  WW  WWWWWW  WW      WW  WW   WW  WWWW        |
|                                                                             |
|                                                                             |

...

|=============================================================================|
|                               WHIZARD 3.0.1
|=============================================================================|
| Reading model file &#39;/cvmfs/sw.hsf.org/spackages6/whizard/3.0.1/x86_64-centos7-gcc11.2.0-opt/pmm4s/share/whizard/models/SM.mdl&#39;
| Preloaded model: SM
| Process library &#39;default_lib&#39;: initialized
| Preloaded library: default_lib
| Reading model file &#39;/cvmfs/sw.hsf.org/spackages6/whizard/3.0.1/x86_64-centos7-gcc11.2.0-opt/pmm4s/share/whizard/models/SM_hadrons.mdl&#39;
| Reading commands from file &#39;Z_mumu.sin&#39;
| Switching to model &#39;SM&#39;, scheme &#39;default&#39;

...

$description = &quot;A WHIZARD 3.0 Example.
   Z -&gt; mumu @ 91.2 events for FCC ee.&quot;
$y_label = &quot;$N_{\textrm{events}}$&quot;
$sample = &quot;z_mumu&quot;
| Starting simulation for process &#39;zmumu&#39;
| Simulate: using integration grids from file &#39;zmumu.m1.vg&#39;
| RNG: Initializing TAO random-number generator
| RNG: Setting seed for random-number generator to 22345
| Simulation: requested number of events = 1000
|             corr. to luminosity [fb-1] =   6.6285E-04
| Events: writing to HepMC file &#39;z_mumu.hepmc&#39;
| Events: writing to raw file &#39;z_mumu.evx&#39;
| Events: generating 1000 unweighted, unpolarized events ...
| Events: event normalization mode &#39;1&#39;
|         ... event sample complete.
| Events: actual unweighting efficiency =   1.16 %
Warning: Encountered events with excess weight: 6 events (  0.600 %)
| Maximum excess weight = 2.465E+00
| Average excess weight = 4.511E-03
| Events: closing HepMC file &#39;z_mumu.hepmc&#39;
| Events: closing raw file &#39;z_mumu.evx&#39;
| There were no errors and    2 warning(s).
| WHIZARD run finished.
|=============================================================================|
</pre></div>
</div>
</div>
<p>The file <code class="docutils literal notranslate"><span class="pre">z_mumu.hepmc</span></code> contains 100 e<sup>+</sup>e<sup>-</sup> → mu<sup>+</sup>mu<sup>-</sup>(gamma) events in HepMC 3 format .</p>
</section>
<section id="madgraph5">
<h3><span class="section-number">2.1.3.4. </span>MadGraph5<a class="headerlink" href="#madgraph5" title="Link to this heading"></a></h3>
<p>MadGraph5 is available as standalone program:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>which<span class="w"> </span>mg5_aMC
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">spackages6</span><span class="o">/</span><span class="n">madgraph5amc</span><span class="o">/</span><span class="mf">2.8.1</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">centos7</span><span class="o">-</span><span class="n">gcc11</span><span class="mf">.2.0</span><span class="o">-</span><span class="n">opt</span><span class="o">/</span><span class="mi">3</span><span class="n">tclk</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">mg5_aMC</span>
</pre></div>
</div>
</section>
<section id="herwig">
<h3><span class="section-number">2.1.3.5. </span>Herwig<a class="headerlink" href="#herwig" title="Link to this heading"></a></h3>
<p>Herwig is available as standalone program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">which</span> <span class="n">Herwig</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">spackages6</span><span class="o">/</span><span class="n">herwig3</span><span class="o">/</span><span class="mf">7.2.3</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">centos7</span><span class="o">-</span><span class="n">gcc11</span><span class="mf">.2.0</span><span class="o">-</span><span class="n">opt</span><span class="o">/</span><span class="mi">5</span><span class="n">d2cb</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">Herwig</span>
</pre></div>
</div>
</section>
<section id="kkmcee">
<h3><span class="section-number">2.1.3.6. </span>KKMCee<a class="headerlink" href="#kkmcee" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">KKMCee</span></code> is an adaptation of the <code class="docutils literal notranslate"><span class="pre">KKMC</span></code> Monte Carlo generator (the latest version of the <code class="docutils literal notranslate"><span class="pre">Koral</span></code> generators) to the
case of FCC-ee.
KKMCee is available as standalone program when using the key4hep stack:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>which<span class="w"> </span>KKMCee
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">spackages6</span><span class="o">/</span><span class="n">kkmcee</span><span class="o">/</span><span class="mf">5.00.02</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">centos7</span><span class="o">-</span><span class="n">gcc11</span><span class="mf">.2.0</span><span class="o">-</span><span class="n">opt</span><span class="o">/</span><span class="n">eodg6</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">KKMCee</span>
</pre></div>
</div>
<p>A help function is available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KKMCee</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Show help function output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+++</span> <span class="n">Wrapper</span> <span class="n">around</span> <span class="n">the</span> <span class="n">KKMCee</span> <span class="n">executable</span>  <span class="o">+++</span>

<span class="n">Usage</span><span class="p">:</span> \<span class="n">tKKMCee</span> <span class="o">-</span><span class="n">f</span> <span class="n">Mu</span><span class="o">|</span><span class="n">Tau</span><span class="o">|</span><span class="n">UDS</span><span class="o">|</span><span class="n">C</span><span class="o">|</span><span class="n">B</span><span class="o">|</span><span class="n">Hadrons</span> <span class="o">-</span><span class="n">e</span> <span class="n">Ecms</span> <span class="o">-</span><span class="n">n</span> <span class="n">Nevts</span> <span class="o">-</span><span class="n">o</span> <span class="n">output_file</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">initial_seed</span><span class="p">]</span> <span class="p">[</span><span class="n">OPTIONS</span><span class="p">]</span>
       \<span class="n">tKKMCee</span> <span class="o">-</span><span class="n">c</span> <span class="n">config_file</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">initial_seed</span><span class="p">]</span>

<span class="n">Options</span><span class="p">:</span>
  <span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="o">--</span><span class="n">config</span> <span class="n">file</span> 		<span class="n">Path</span> <span class="n">to</span> <span class="n">configuration</span> <span class="n">file</span>
  <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="o">--</span><span class="n">flavour</span> <span class="n">flavour</span> 	<span class="n">Flavour</span> <span class="n">to</span> <span class="n">be</span> <span class="n">generated</span> <span class="p">(</span><span class="n">Mu</span><span class="o">|</span><span class="n">Tau</span><span class="o">|</span><span class="n">UDS</span><span class="o">|</span><span class="n">C</span><span class="o">|</span><span class="n">B</span><span class="o">|</span><span class="n">Hadrons</span><span class="p">)</span>
  <span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="o">--</span><span class="n">ecms</span> <span class="n">energy</span> 		<span class="n">Center</span> <span class="n">of</span> <span class="n">Mass</span> <span class="n">energy</span> <span class="ow">in</span> <span class="n">GeV</span>
  <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="o">--</span><span class="n">nevts</span> <span class="n">events</span> 		<span class="n">Number</span> <span class="n">of</span> <span class="n">events</span> <span class="n">to</span> <span class="n">be</span> <span class="n">generated</span>
  <span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="o">--</span><span class="n">outfile</span> <span class="n">file</span> 		<span class="n">File</span> <span class="k">with</span> <span class="n">the</span> <span class="n">generated</span> <span class="n">events</span> <span class="ow">in</span> <span class="n">HEPMCv3</span> <span class="nb">format</span> <span class="p">[</span><span class="n">kkmcee</span><span class="o">.</span><span class="n">hepmc</span><span class="p">]</span>
  <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="o">--</span><span class="n">initialseed</span> 		<span class="n">Long</span> <span class="n">number</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="k">for</span> <span class="n">initial</span> <span class="n">seeding</span> <span class="p">(</span><span class="n">randomly</span> <span class="n">generated</span><span class="p">,</span> <span class="k">if</span> <span class="n">missing</span><span class="p">)</span>
  <span class="o">-</span><span class="n">b</span><span class="p">,</span> <span class="o">--</span><span class="n">bessig</span> <span class="n">bessig</span> 		<span class="n">Beam</span><span class="o">-</span><span class="n">Energy</span><span class="o">-</span><span class="n">Spread</span> <span class="n">of</span> <span class="n">both</span> <span class="n">beams</span> <span class="p">(</span><span class="ow">or</span> <span class="n">of</span> <span class="n">the</span> <span class="n">first</span> <span class="n">beam</span><span class="p">,</span> <span class="k">if</span> <span class="n">bessig2</span><span class="o">&lt;</span><span class="mf">0.</span><span class="p">)</span>
                      		<span class="p">[</span><span class="n">fraction</span> <span class="n">of</span> <span class="n">Ecms</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span> <span class="o">-</span><span class="mf">1.</span> <span class="p">(</span><span class="n">no</span> <span class="n">spread</span><span class="p">)]</span>
  <span class="o">-</span><span class="n">g</span><span class="p">,</span> <span class="o">--</span><span class="n">bessig2</span> <span class="n">bessig2</span> 	<span class="n">Beam</span><span class="o">-</span><span class="n">Energy</span><span class="o">-</span><span class="n">Spread</span> <span class="n">of</span> <span class="n">the</span> <span class="n">second</span> <span class="n">beam</span> <span class="k">if</span> <span class="n">different</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">first</span> <span class="n">beam</span><span class="p">;</span> <span class="n">fraction</span> <span class="n">of</span> <span class="n">Ecms</span><span class="o">/</span><span class="mf">2.</span>
                      		<span class="p">[</span><span class="n">fraction</span> <span class="n">of</span> <span class="n">Ecms</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span> <span class="o">-</span><span class="mf">1.</span> <span class="p">(</span><span class="n">no</span> <span class="n">spread</span> <span class="ow">or</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">first</span> <span class="n">beam</span><span class="p">)]</span>
  <span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="o">--</span><span class="n">besrho</span> <span class="n">rho</span> 		<span class="n">Beam</span><span class="o">-</span><span class="n">Energy</span><span class="o">-</span><span class="n">Spread</span> <span class="n">correlation</span> <span class="p">[</span><span class="n">default</span> <span class="mf">0.</span><span class="p">]</span>
  <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">--</span><span class="n">debug</span> <span class="n">lvl</span> 		 <span class="n">PrintOut</span> <span class="n">Level</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span> <span class="p">[</span><span class="n">default</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">Special</span> <span class="n">options</span> <span class="k">for</span> <span class="n">taus</span> <span class="n">only</span><span class="p">:</span>
  <span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="o">--</span><span class="n">taudec</span> <span class="n">t1</span><span class="o">*</span><span class="mi">1000</span><span class="o">+</span><span class="n">t2</span> 	<span class="n">decay</span> <span class="n">channel</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="p">(</span><span class="n">t1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">second</span> <span class="n">tau</span> <span class="p">(</span><span class="n">t2</span><span class="p">)</span>
                      		 <span class="mi">0</span>        <span class="n">Inclusive</span>
                      		 <span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>    <span class="n">electron</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">pi</span>
                      		 <span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span>  <span class="n">rho</span><span class="p">,</span><span class="n">a1</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">K</span><span class="o">*</span>
                      		 <span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span>  <span class="mi">3</span><span class="n">pip0</span><span class="p">,</span><span class="n">pi3pi0</span><span class="p">,</span><span class="mi">3</span><span class="n">pi2pi0</span><span class="p">,</span><span class="mi">5</span><span class="n">pi</span><span class="p">,</span><span class="mi">5</span><span class="n">pip0</span><span class="p">,</span><span class="mi">3</span><span class="n">pi3p0</span>
                      		 <span class="mi">14</span><span class="p">,</span> <span class="o">...</span> <span class="p">(</span><span class="n">other</span> <span class="n">rare</span> <span class="n">decays</span> <span class="n">see</span> <span class="n">tauola</span><span class="o">++</span><span class="p">)</span>
  <span class="o">--</span><span class="n">tauopt</span> <span class="n">file</span> 		<span class="n">File</span> <span class="k">with</span> <span class="n">tau</span> <span class="n">options</span> <span class="p">(</span><span class="n">see</span> <span class="n">Tauola</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">KKMCee_defaults</span><span class="p">)</span>
                      		 <span class="n">the</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">included</span> <span class="k">as</span> <span class="n">it</span> <span class="ow">is</span> <span class="ow">and</span> <span class="n">overwrites</span> <span class="n">other</span> <span class="n">settings</span>

<span class="n">Examples</span><span class="p">:</span>
<span class="n">KKMCee</span> <span class="o">-</span><span class="n">f</span> <span class="n">Mu</span> <span class="o">-</span><span class="n">e</span> <span class="mf">91.2</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">o</span> <span class="n">kkmu_10000</span><span class="o">.</span><span class="n">hepmc</span> <span class="o">-</span><span class="n">b</span> <span class="mf">0.001</span>
<span class="n">KKMCee</span> <span class="o">-</span><span class="n">c</span> <span class="n">kkmc_ditau</span><span class="o">.</span><span class="n">input</span>
<span class="n">KKMCee</span> <span class="o">-</span><span class="n">f</span> <span class="n">B</span> <span class="o">-</span><span class="n">e</span> <span class="mf">91.2</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1000</span> <span class="o">-</span><span class="n">o</span> <span class="n">kkbb_1000</span><span class="o">.</span><span class="n">hepmc</span>

  <span class="n">NB</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">This</span> <span class="n">wrapper</span> <span class="n">works</span> <span class="n">only</span> <span class="k">for</span> <span class="n">KKMCee</span> <span class="n">versions</span> <span class="mi">5</span> <span class="ow">or</span> <span class="n">newer</span>
      <span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">Output</span> <span class="ow">is</span> <span class="n">HEPMC</span> <span class="n">v3</span>
</pre></div>
</div>
</div>
<p>Note that the BES (Beam Energy Spread) options are only available in version 4.32.01 and higher.</p>
<p>A configuration example file for taus is available under at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ls `dirname $( which KKMCee )`/../share/KKMCee/examples/kkmc-tauola.input
</pre></div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Show dimuon example</p>
<p>To generate a sample of dimuon events using the example files, do the following</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>KKMCee<span class="w"> </span>-f<span class="w"> </span>Mu<span class="w"> </span>-e<span class="w"> </span><span class="m">91</span>.2<span class="w"> </span>-n<span class="w"> </span><span class="m">1000</span><span class="w"> </span>-o<span class="w"> </span>kkmu_1000.hepmc
</pre></div>
</div>
<p>The output should look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Seeds: 29318493 48191772
  29318493      IJKLIN= 29318493  48191772
         0      NTOTIN= 0
         0      NTOT2N= 0
  ------- starting from the scratch ----------
ranmar initialized: ij,kl,ijkl,ntot,ntot2=       974     18625  29318493         0         0
        1000  requested events
 ---------------
 ****************************
 *    KK2f_ReaDataX Starts  *
 ****************************
 ---------------
 ---------------
 ---------------
 ---------------
 ---------------
BeginX
********************************************************************************
*               ACTUAL DATA FOR THIS PARTICULAR RUN
********************************************************************************
*indx_____data______ccccccccc0ccccccccc0ccccccccc0ccccccccc0ccccccccc0ccccccccc0
*     Center-of-mass energy [GeV]
    1    91.0000         CMSene =xpar( 1) Average Center of mass energy [GeV]
********************************************************************************
*     Define process
  413    1.00000          KFfin, muon
  100    1.00000          store lhe file to (LHE_OUT.LHE)
 ---------------          26          36 LHE_OUT.LHE
************************* one can change the lhf file name between brackets
********************************************************************************
EndX
 **************************
 *   KK2f_ReaDataX Ends   *
 **************************
 Tables are READ from DiskFile  dizet/table.down
amz,amh,amtop,swsq,gammz,amw,gammw=
     =  91.1876000 125.1000000 173.0000000   0.2234020   2.4953766  80.3588894   2.0898788
 
 ...
 
 

                            Event listing (summary)

    I particle/jet KS     KF  orig    p_x      p_y      p_z       E        m

    1 !e-!         21      11    0    0.000    0.000   45.500   45.500    0.001
    2 !e+!         21     -11    0    0.000    0.000  -45.500   45.500    0.001
    3 (Z0)         11      23    1    0.039    0.001    0.115   90.879   90.879
    4 gamma         1      22    1    0.000    0.000   -0.001    0.001    0.000
    5 gamma         1      22    1   -0.039   -0.001   -0.114    0.120    0.000
    6 mu-           1      13    3   14.678    0.229   43.067   45.500    0.106
    7 mu+           1     -13    3  -14.639   -0.229  -42.952   45.379    0.106
                   sum:  0.00         0.000    0.000    0.000   91.000   91.000
 iev=          501
  generation finished
  xSecPb, xErrPb =   1442.5021729176829        13.903134156944603
++++++++++++++++++++++++++++++++++++++++++++++++++++++
++    GLK_PRINT: bmin.eq.bmax, id=     50004 ++
++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++
++    GLK_PRINT: bmin.eq.bmax, id=     50005 ++
++++++++++++++++++++++++++++++++++++++++++++++++++++++

real	0m4.043s
user	0m3.777s
sys	0m0.085s
</pre></div>
</div>
</div>
<p>and a file <code class="docutils literal notranslate"><span class="pre">kkmu_1000.hepmc</span></code> created.</p>
<p><code class="docutils literal notranslate"><span class="pre">KKMCee</span></code> creates several files during its run. These are saved into a folder called <code class="docutils literal notranslate"><span class="pre">KKMCee-&lt;date&gt;-&lt;time&gt;</span></code>, for example <code class="docutils literal notranslate"><span class="pre">KKMCee-12Oct2022-191047</span></code>.
This folder contains the files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls KKMCee-12Oct2022-191047
DIZET-table1  TabMain77.output  TabMainC.output  mcgen.root  pro.input  pro.output  pro77.output
</pre></div>
</div>
<p>The file <code class="docutils literal notranslate"><span class="pre">pro.input</span></code> contains the configuration options and can be used to repeat the run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>KKMCee<span class="w"> </span>-c<span class="w"> </span>KKMCee-12Oct2022-191047/pro.input
</pre></div>
</div>
<p>and, of course, as base configuration file example for further variations.</p>
</section>
<section id="bhlumi">
<h3><span class="section-number">2.1.3.7. </span>BHLUMI<a class="headerlink" href="#bhlumi" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">BHLUMI</span></code> is a Monte Carlo generator of Bhabha events used at LEP for luminosity studies.
BHLUMI is available as standalone program when using the key4hep stack:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>which<span class="w"> </span>BHLUMI
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">spackages4</span><span class="o">/</span><span class="n">bhlumi</span><span class="o">/</span><span class="mf">4.04</span><span class="o">-</span><span class="n">linuxLHE</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">centos7</span><span class="o">-</span><span class="n">gcc8</span><span class="mf">.3.0</span><span class="o">-</span><span class="n">opt</span><span class="o">/</span><span class="n">o7rmcus</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">BHLUMI</span>
</pre></div>
</div>
<p>A help function is available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BHLUMI</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Show help function output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+++</span> <span class="n">Wrapper</span> <span class="n">around</span> <span class="n">the</span> <span class="n">BHLUMI</span><span class="o">.</span><span class="n">exe</span> <span class="n">executable</span> <span class="o">+++</span>

<span class="n">Usage</span><span class="p">:</span> 	<span class="n">BHLUMI</span> <span class="o">-</span><span class="n">e</span> <span class="n">Ecms</span> <span class="o">-</span><span class="n">n</span> <span class="n">Nevts</span> <span class="o">-</span><span class="n">f</span> <span class="n">Thmin</span> <span class="o">-</span><span class="n">t</span> <span class="n">Thmax</span> <span class="o">-</span><span class="n">x</span> <span class="n">epscms</span> <span class="o">-</span><span class="n">o</span> <span class="n">output_file</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">seed_file</span><span class="p">]</span>
       	<span class="n">BHLUMI</span> <span class="o">-</span><span class="n">c</span> <span class="n">config_file</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">seed_file</span><span class="p">]</span>

<span class="n">Switches</span><span class="p">:</span>
  <span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="o">--</span><span class="n">config</span> <span class="n">file</span> 		<span class="n">Path</span> <span class="n">to</span> <span class="n">configuration</span> <span class="n">file</span>
  <span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="o">--</span><span class="n">ecms</span> <span class="n">energy</span> 		<span class="n">Center</span> <span class="n">of</span> <span class="n">Mass</span> <span class="n">energy</span> <span class="ow">in</span> <span class="n">GeV</span>
  <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="o">--</span><span class="n">nevts</span> <span class="n">energy</span> 		<span class="n">Number</span> <span class="n">of</span> <span class="n">events</span> <span class="n">to</span> <span class="n">be</span> <span class="n">generated</span>
  <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="o">--</span><span class="n">Thmin</span> <span class="n">theta</span> 		<span class="n">Minimum</span> <span class="n">theta</span> <span class="p">[</span><span class="n">rad</span><span class="p">]</span>
  <span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="o">--</span><span class="n">Thmax</span> <span class="n">theta</span> 		<span class="n">Maximum</span> <span class="n">theta</span> <span class="p">[</span><span class="n">rad</span><span class="p">]</span>
  <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">--</span><span class="n">epscms</span> <span class="n">fraction</span> 	<span class="n">Energy</span> <span class="n">cut</span><span class="o">-</span><span class="n">off</span> <span class="ow">in</span>  <span class="n">fraction</span> <span class="n">of</span> <span class="n">Ecms</span>
  <span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="o">--</span><span class="n">outfile</span> <span class="n">file</span> 		<span class="n">File</span> <span class="k">with</span> <span class="n">the</span> <span class="n">generated</span> <span class="n">events</span> <span class="ow">in</span> <span class="n">LHE</span> <span class="nb">format</span>
  <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="o">--</span><span class="n">seedfile</span> <span class="n">file</span> 		<span class="n">File</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="k">for</span> <span class="n">seeding</span> <span class="p">(</span><span class="n">randomly</span> <span class="n">generated</span><span class="p">,</span> <span class="k">if</span> <span class="n">missing</span><span class="p">)</span>

<span class="n">Examples</span><span class="p">:</span>
<span class="n">BHLUMI</span> <span class="o">-</span><span class="n">f</span> <span class="mf">0.022</span> <span class="o">-</span><span class="n">t</span> <span class="mf">0.082</span> <span class="o">-</span><span class="n">x</span> <span class="mf">0.001</span> <span class="o">-</span><span class="n">e</span> <span class="mf">91.2</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">o</span> <span class="n">kkmu_10000</span><span class="o">.</span><span class="n">LHE</span>
<span class="n">BHLUMI</span> <span class="o">-</span><span class="n">c</span> <span class="n">bhlumi</span><span class="o">.</span><span class="n">input</span>

<span class="n">Additional</span> <span class="n">switches</span> <span class="p">(</span><span class="k">for</span> <span class="n">experts</span> <span class="n">only</span><span class="p">):</span>
  <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="o">--</span><span class="n">keyopt</span> <span class="n">KEYOPT</span> 		<span class="n">Technical</span> <span class="n">parameters</span> <span class="n">switch</span> <span class="p">[</span><span class="n">default</span> <span class="mi">3021</span><span class="p">]</span>
  				<span class="n">KEYOPT</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="n">KEYGEN</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="n">KEYREM</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">KEYWGT</span> <span class="o">+</span> <span class="n">KEYRND</span>
  <span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="o">--</span><span class="n">keyrad</span> <span class="n">KEYRAD</span> 		<span class="n">Physics</span> <span class="n">parameters</span> <span class="n">switch</span> <span class="p">[</span><span class="n">default</span> <span class="mi">1021</span><span class="p">]</span>
  				<span class="n">KEYRAD</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="n">KEYZET</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="n">KEYUPD</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">KEYMOD</span> <span class="o">+</span> <span class="n">KEYPIA</span>
  <span class="p">(</span><span class="n">Contact</span> <span class="n">BHLUMI</span> <span class="n">authors</span> <span class="k">for</span> <span class="n">details</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">through</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">KrakowHEPSoft</span><span class="o">/</span><span class="n">BHLUMI</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="babayaga">
<h3><span class="section-number">2.1.3.8. </span>BabaYaga<a class="headerlink" href="#babayaga" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">BabaYaga</span></code> is a Monte Carlo generator of two-photons events used at LEP.
BabaYaga is available as standalone program when using the key4hep stack:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>which<span class="w"> </span>babayaga
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">cvmfs</span><span class="o">/</span><span class="n">sw</span><span class="o">.</span><span class="n">hsf</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">spackages4</span><span class="o">/</span><span class="n">babayaga</span><span class="o">/</span><span class="n">fcc</span><span class="o">-</span><span class="mf">1.0.0</span><span class="o">/</span><span class="n">x86_64</span><span class="o">-</span><span class="n">centos7</span><span class="o">-</span><span class="n">gcc8</span><span class="mf">.3.0</span><span class="o">-</span><span class="n">opt</span><span class="o">/</span><span class="n">jsgdir7</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">babayaga</span>
</pre></div>
</div>
<p>A help function is available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">babayaga</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Show help function output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
<span class="o">+++</span> <span class="n">Wrapper</span> <span class="n">around</span> <span class="n">the</span> <span class="n">babayaga</span><span class="o">-</span><span class="n">fcc</span><span class="o">.</span><span class="n">exe</span> <span class="n">executable</span> <span class="o">+++</span>

<span class="o">+++</span> <span class="n">Process</span><span class="p">:</span> <span class="n">e</span><span class="o">+</span><span class="n">e</span><span class="o">-</span> <span class="o">-&gt;</span> <span class="n">gamma</span> <span class="n">gamma</span>

<span class="n">Usage</span><span class="p">:</span> 	<span class="n">babayaga</span> <span class="o">-</span><span class="n">e</span> <span class="n">Ecms</span> <span class="o">-</span><span class="n">n</span> <span class="n">Nevts</span> <span class="o">-</span><span class="n">f</span> <span class="n">Thmin</span> <span class="o">-</span><span class="n">t</span> <span class="n">Thmax</span> <span class="o">-</span><span class="n">x</span> <span class="n">epscms</span> <span class="o">-</span><span class="n">o</span> <span class="n">output_file</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">seed</span><span class="p">]</span>
       	<span class="n">babayaga</span> <span class="o">-</span><span class="n">c</span> <span class="n">config_file</span> <span class="p">[</span><span class="o">-</span><span class="n">s</span> <span class="n">seed</span><span class="p">]</span>

<span class="n">Switches</span><span class="p">:</span>
  <span class="o">-</span><span class="n">c</span><span class="p">,</span> <span class="o">--</span><span class="n">config</span> <span class="n">file</span> 		<span class="n">Path</span> <span class="n">to</span> <span class="n">configuration</span> <span class="n">file</span>
  <span class="o">-</span><span class="n">e</span><span class="p">,</span> <span class="o">--</span><span class="n">ecms</span> <span class="n">energy</span> 		<span class="n">Center</span> <span class="n">of</span> <span class="n">Mass</span> <span class="n">energy</span> <span class="ow">in</span> <span class="n">GeV</span>
  <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="o">--</span><span class="n">nevts</span> <span class="n">energy</span> 		<span class="n">Number</span> <span class="n">of</span> <span class="n">events</span> <span class="n">to</span> <span class="n">be</span> <span class="n">generated</span>
  <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="o">--</span><span class="n">Thmin</span> <span class="n">angle</span> 		<span class="n">Minimum</span> <span class="n">theta</span> <span class="p">[</span><span class="n">deg</span><span class="p">]</span>
  <span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="o">--</span><span class="n">Thmax</span> <span class="n">angle</span> 		<span class="n">Maximum</span> <span class="n">theta</span> <span class="p">[</span><span class="n">deg</span><span class="p">]</span>
  <span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="o">--</span><span class="n">acolmax</span> <span class="n">angle</span> 		<span class="n">Max</span> <span class="n">acollinearity</span> <span class="p">[</span><span class="n">deg</span><span class="p">]</span>
  <span class="o">-</span><span class="n">m</span><span class="p">,</span> <span class="o">--</span><span class="n">emin</span> <span class="n">energy</span> 		<span class="n">Min</span> <span class="n">energy</span> <span class="ow">in</span> <span class="n">GeV</span>
  <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="o">--</span><span class="n">eps</span> <span class="n">fraction</span> 		<span class="n">Soft</span><span class="o">-</span><span class="n">photon</span> <span class="n">cut</span><span class="o">-</span><span class="n">off</span>
  <span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="o">--</span><span class="n">outfile</span> <span class="n">file</span> 		<span class="n">File</span> <span class="k">with</span> <span class="n">the</span> <span class="n">generated</span> <span class="n">events</span> <span class="ow">in</span> <span class="n">LHE</span> <span class="nb">format</span>
  <span class="o">-</span><span class="n">w</span><span class="p">,</span> <span class="o">--</span><span class="n">outdir</span> <span class="n">path</span> 		<span class="n">Path</span> <span class="k">with</span> <span class="n">working</span> <span class="n">space</span> <span class="p">(</span><span class="ow">and</span> <span class="n">residual</span> <span class="n">files</span><span class="p">)</span>
  <span class="o">-</span><span class="n">s</span><span class="p">,</span> <span class="o">--</span><span class="n">seed</span> <span class="n">number</span> 		<span class="n">Number</span> <span class="n">used</span> <span class="k">for</span> <span class="n">seeding</span> <span class="p">(</span><span class="n">randomly</span> <span class="n">generated</span><span class="p">,</span> <span class="k">if</span> <span class="n">missing</span><span class="p">)</span>
  <span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="o">--</span><span class="n">debug</span> <span class="n">number</span> 		<span class="n">Debug</span> <span class="n">level</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

<span class="n">Examples</span><span class="p">:</span>
<span class="n">babayaga</span> <span class="o">-</span><span class="n">f</span> <span class="mf">15.</span> <span class="o">-</span><span class="n">t</span> <span class="mf">165.</span> <span class="o">-</span><span class="n">e</span> <span class="mf">91.2</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">o</span> <span class="n">bbyg_10000</span><span class="o">.</span><span class="n">LHE</span>
<span class="n">babayaga</span> <span class="o">-</span><span class="n">c</span> <span class="n">babayaga</span><span class="o">.</span><span class="n">input</span> <span class="o">-</span><span class="n">o</span> <span class="n">bbyg</span><span class="o">.</span><span class="n">LHE</span>

</pre></div>
</div>
</div>
</section>
</section>
<section id="hands-on-case-study-ditau-events-with-kkmcee-pythia8-and-whizard">
<h2><span class="section-number">2.1.4. </span>Hands-on case study: ditau events with KKMCee, Pythia8 and Whizard<a class="headerlink" href="#hands-on-case-study-ditau-events-with-kkmcee-pythia8-and-whizard" title="Link to this heading"></a></h2>
<p>In this section we describe, with exercises, the generation of an equivalent sample of Monte Carlo events with three diffent generators,
<code class="docutils literal notranslate"><span class="pre">KKMCee</span></code>, <code class="docutils literal notranslate"><span class="pre">Pythia8</span></code> and <code class="docutils literal notranslate"><span class="pre">Whizard</span></code>. The process chosen is e<sup>-</sup>e<sup>+</sup> → tau<sup>-</sup>tau<sup>+</sup> (hereafter referred to as <em>ditaus</em>) at a centre of mass energy of 91.2 GeV. In the three cases 10000 will be generated and saved in <code class="docutils literal notranslate"><span class="pre">ROOT</span></code> files in <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> format.</p>
<section id="generating-ditaus-with-kkmcee">
<h3><span class="section-number">2.1.4.1. </span>Generating ditaus with KKMCee<a class="headerlink" href="#generating-ditaus-with-kkmcee" title="Link to this heading"></a></h3>
<p>As shown in the <a class="reference internal" href="#kkmcee">KKMCee section</a>, event generation with the <code class="docutils literal notranslate"><span class="pre">KKMCee</span></code> is controlled through a configuration file. The interface available in <code class="docutils literal notranslate"><span class="pre">key4hep</span></code> allowed a generation of the configuration file through command line switches. Starting from the command line switches is therefore always a good option when no confguration file is available.</p>
<p>Currently, <code class="docutils literal notranslate"><span class="pre">KKMCee</span></code> does not have the option to save directly the events in <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> format. In order to get there we need first to generate the events in <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> format.</p>
<section id="generating-hepmc-events">
<h4><span class="section-number">2.1.4.1.1. </span>Generating <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> events<a class="headerlink" href="#generating-hepmc-events" title="Link to this heading"></a></h4>
<p>What are the commands (options) to generate 10000 ditau events and saved them into the file kk_tautau_10000.hepmc ?</p>
<div class="toggle admonition">
<p class="admonition-title">Suggested answer</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>KKMCee<span class="w"> </span>-f<span class="w"> </span>Tau<span class="w"> </span>-e<span class="w"> </span><span class="m">91</span>.2<span class="w"> </span>-n<span class="w"> </span><span class="m">10000</span><span class="w"> </span>-o<span class="w"> </span>kk_tautau_10000.hepmc
</pre></div>
</div>
</div>
<div class="toggle admonition">
<p class="admonition-title">Expand to see the example of the produced <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> output</p>
<p>The <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> output is an ASCII format and can browsed with for example <code class="docutils literal notranslate"><span class="pre">more</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>more<span class="w"> </span>kk_tautau_10000.hepmc
HepMC::Version<span class="w"> </span><span class="m">3</span>.02.04
HepMC::Asciiv3-START_EVENT_LISTING
E<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">11</span>
U<span class="w"> </span>GEV<span class="w"> </span>MM
A<span class="w"> </span><span class="m">4</span><span class="w"> </span>spin<span class="w"> </span><span class="m">0</span>.056005<span class="w"> </span>-0.954208<span class="w"> </span><span class="m">0</span>.293856
A<span class="w"> </span><span class="m">5</span><span class="w"> </span>spin<span class="w"> </span><span class="m">0</span>.862823<span class="w"> </span><span class="m">0</span>.105210<span class="w"> </span><span class="m">0</span>.494436
P<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">4</span>.5599999997136848e+01<span class="w"> </span><span class="m">4</span>.5600000000000001e+01<span class="w"> </span><span class="m">5</span>.1099859770630950e-04<span class="w"> </span><span class="m">4</span>
P<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-11<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span>-4.5599999997136848e+01<span class="w"> </span><span class="m">4</span>.5600000000000001e+01<span class="w"> </span><span class="m">5</span>.1099859770630950e-04<span class="w"> </span><span class="m">4</span>
V<span class="w"> </span>-1<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>,2<span class="o">]</span>
P<span class="w"> </span><span class="m">3</span><span class="w"> </span>-1<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">9</span>.1200000000000003e+01<span class="w"> </span><span class="m">9</span>.1200000000000003e+01<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">7</span>.5634198134957833e+00<span class="w"> </span><span class="m">1</span>.9208578260382165e+01<span class="w"> </span>-4.0620528002933362e+01<span class="w"> </span><span class="m">4</span>.5600000000000001e+01<span class="w"> </span><span class="m">1</span>.7770499999998681e+00<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">3</span><span class="w"> </span>-15<span class="w"> </span>-7.5634198134957833e+00<span class="w"> </span>-1.9208578260382165e+01<span class="w"> </span><span class="m">4</span>.0620528002933362e+01<span class="w"> </span><span class="m">4</span>.5600000000000001e+01<span class="w"> </span><span class="m">1</span>.7770499999998681e+00<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">1</span>.5520648658275604e-01<span class="w"> </span><span class="m">1</span>.3736795186996460e+00<span class="w"> </span>-3.0399644374847412e+00<span class="w"> </span><span class="m">3</span>.3395311832427979e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">3</span>.3498418331146240e+00<span class="w"> </span><span class="m">7</span>.8049712181091309e+00<span class="w"> </span>-1.7384153366088867e+01<span class="w"> </span><span class="m">1</span>.9348358154296875e+01<span class="w"> </span><span class="m">1</span>.0565830000000000e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">4</span><span class="w"> </span>-14<span class="w"> </span><span class="m">4</span>.0583715438842773e+00<span class="w"> </span><span class="m">1</span>.0029928207397461e+01<span class="w"> </span>-2.0196411132812500e+01<span class="w"> </span><span class="m">2</span>.2912111282348633e+01<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">5</span><span class="w"> </span>-16<span class="w"> </span>-3.4257166385650635e+00<span class="w"> </span>-9.4930477142333984e+00<span class="w"> </span><span class="m">2</span>.1268466949462891e+01<span class="w"> </span><span class="m">2</span>.3541477203369141e+01<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">211</span><span class="w"> </span>-9.6522146463394165e-01<span class="w"> </span>-2.8242239952087402e+00<span class="w"> </span><span class="m">5</span>.9299035072326660e+00<span class="w"> </span><span class="m">6</span>.6401152610778809e+00<span class="w"> </span><span class="m">1</span>.3957587329547499e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">111</span><span class="w"> </span>-3.1724817752838135e+00<span class="w"> </span>-6.8913059234619141e+00<span class="w"> </span><span class="m">1</span>.3422157287597656e+01<span class="w"> </span><span class="m">1</span>.5418406486511230e+01<span class="w"> </span><span class="m">1</span>.3496067957561880e-01<span class="w"> </span><span class="m">1</span>
E<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">22</span>
U<span class="w"> </span>GEV<span class="w"> </span>MM
A<span class="w"> </span><span class="m">10</span><span class="w"> </span>spin<span class="w"> </span>-0.526312<span class="w"> </span>-0.653062<span class="w"> </span><span class="m">0</span>.544523
A<span class="w"> </span><span class="m">11</span><span class="w"> </span>spin<span class="w"> </span><span class="m">0</span>.124883<span class="w"> </span><span class="m">0</span>.876618<span class="w"> </span>-0.464700
P<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>-11<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span>-4.5599999997136848e+01<span class="w"> </span><span class="m">4</span>.5600000000000001e+01<span class="w"> </span><span class="m">5</span>.1099859770630950e-04<span class="w"> </span><span class="m">4</span>
P<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>-11<span class="w"> </span><span class="m">2</span>.3989162307273351e-04<span class="w"> </span><span class="m">3</span>.2683144961857383e-05<span class="w"> </span>-4.5053509135514268e+01<span class="w"> </span><span class="m">4</span>.5053509084747823e+01<span class="w"> </span>-2.1524472631665264e-03<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">22</span><span class="w"> </span>-2.3989162307273351e-04<span class="w"> </span>-3.2683144961857383e-05<span class="w"> </span>-5.4649086162257743e-01<span class="w"> </span><span class="m">5</span>.4649091525218030e-01<span class="w"> </span>-1.2904784139758924e-08<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">4</span>.5599999997136848e+01<span class="w"> </span><span class="m">4</span>.5600000000000001e+01<span class="w"> </span><span class="m">5</span>.1099859770630950e-04<span class="w"> </span><span class="m">4</span>
P<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>-3.4272383325468539e-06<span class="w"> </span><span class="m">3</span>.9756556219599252e-05<span class="w"> </span><span class="m">4</span>.5471392649338441e+01<span class="w"> </span><span class="m">4</span>.5471392646010933e+01<span class="w"> </span>-5.5154828810563322e-04<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">3</span>.4272383325468539e-06<span class="w"> </span>-3.9756556219599252e-05<span class="w"> </span><span class="m">1</span>.2860734779840696e-01<span class="w"> </span><span class="m">1</span>.2860735398907067e-01<span class="w"> </span>-3.2261960349397309e-09<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">2</span><span class="w"> </span>-11<span class="w"> </span><span class="m">2</span>.3978439291629699e-04<span class="w"> </span><span class="m">3</span>.1121498922239849e-05<span class="w"> </span>-4.4998932825148202e+01<span class="w"> </span><span class="m">4</span>.4998932774359304e+01<span class="w"> </span>-2.1515941974735880e-03<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">1</span>.0723015643652809e-07<span class="w"> </span><span class="m">1</span>.5616460396175375e-06<span class="w"> </span>-5.4576310366068984e-02<span class="w"> </span><span class="m">5</span>.4576310388516784e-02<span class="w"> </span>-6.5854450798271929e-10<span class="w"> </span><span class="m">1</span>
V<span class="w"> </span>-4<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">[</span><span class="m">5</span>,7<span class="o">]</span>
P<span class="w"> </span><span class="m">9</span><span class="w"> </span>-4<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">2</span>.3635715458375012e-04<span class="w"> </span><span class="m">7</span>.0878055141839101e-05<span class="w"> </span><span class="m">4</span>.7245982419023846e-01<span class="w"> </span><span class="m">9</span>.0470325420370244e+01<span class="w"> </span><span class="m">9</span>.0469091756916228e+01<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">15</span><span class="w"> </span>-1.0567709246763060e+01<span class="w"> </span>-4.0260638458492809e-01<span class="w"> </span><span class="m">4</span>.4181853045814989e+01<span class="w"> </span><span class="m">4</span>.5464630383293809e+01<span class="w"> </span><span class="m">1</span>.7770500000003799e+00<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">9</span><span class="w"> </span>-15<span class="w"> </span><span class="m">1</span>.0567945603917645e+01<span class="w"> </span><span class="m">4</span>.0267726264006992e-01<span class="w"> </span>-4.3709393221624751e+01<span class="w"> </span><span class="m">4</span>.5005695037076428e+01<span class="w"> </span><span class="m">1</span>.7770500000001239e+00<span class="w"> </span><span class="m">2</span>
P<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">16</span><span class="w"> </span>-4.2494945526123047e+00<span class="w"> </span><span class="m">5</span>.3450322151184082e-01<span class="w"> </span><span class="m">1</span>.7407199859619141e+01<span class="w"> </span><span class="m">1</span>.7926362991333008e+01<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">10</span><span class="w"> </span>-211<span class="w"> </span>-3.2984399795532227e+00<span class="w"> </span>-2.7310401201248169e-01<span class="w"> </span><span class="m">1</span>.5218788146972656e+01<span class="w"> </span><span class="m">1</span>.5575150489807129e+01<span class="w"> </span><span class="m">1</span>.3967110514153336e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">111</span><span class="w"> </span>-3.0197749137878418e+00<span class="w"> </span>-6.6400557756423950e-01<span class="w"> </span><span class="m">1</span>.1555866241455078e+01<span class="w"> </span><span class="m">1</span>.1963118553161621e+01<span class="w"> </span><span class="m">1</span>.3497032866486386e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>-16<span class="w"> </span><span class="m">1</span>.3823601500654497e+00<span class="w"> </span><span class="m">5</span>.8997208178366942e-02<span class="w"> </span>-6.8109338674845024e+00<span class="w"> </span><span class="m">6</span>.9500518568222240e+00<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">211</span><span class="w"> </span><span class="m">1</span>.1306452151024036e+00<span class="w"> </span><span class="m">9</span>.9405550031272910e-02<span class="w"> </span>-3.6136840095621445e+00<span class="w"> </span><span class="m">3</span>.7903071607421510e+00<span class="w"> </span><span class="m">1</span>.3955710658047393e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">17</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">211</span><span class="w"> </span><span class="m">2</span>.9148939828773184e+00<span class="w"> </span><span class="m">3</span>.3597977559671632e-01<span class="w"> </span>-1.0436451119833281e+01<span class="w"> </span><span class="m">1</span>.0841977637941852e+01<span class="w"> </span><span class="m">1</span>.3956283150401572e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>-211<span class="w"> </span><span class="m">3</span>.4269614119923486e+00<span class="w"> </span><span class="m">6</span>.2251535093063998e-02<span class="w"> </span>-1.5263612213083412e+01<span class="w"> </span><span class="m">1</span>.5644337452123484e+01<span class="w"> </span><span class="m">1</span>.3963076888122616e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">111</span><span class="w"> </span><span class="m">1</span>.5460559488251355e+00<span class="w"> </span>-1.1916317312948667e-01<span class="w"> </span>-6.7685473667467502e+00<span class="w"> </span><span class="m">6</span>.9452098898073880e+00<span class="w"> </span><span class="m">1</span>.3497443778768972e-01<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">1</span>.3380509514620450e-04<span class="w"> </span>-1.0323115492598167e-05<span class="w"> </span>-3.8742519765868233e-04<span class="w"> </span><span class="m">4</span>.1001055350006228e-04<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">6</span>.4753176789756372e-05<span class="w"> </span><span class="m">3</span>.6976379858981743e-06<span class="w"> </span>-2.6864524513974572e-04<span class="w"> </span><span class="m">2</span>.7636373526067825e-04<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
P<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="m">1</span>.6683033237367961e-01<span class="w"> </span>-3.4786968976788998e-02<span class="w"> </span>-8.1550790025724251e-01<span class="w"> </span><span class="m">8</span>.3312401741426301e-01<span class="w"> </span><span class="m">0</span>.0000000000000000e+00<span class="w"> </span><span class="m">1</span>
...
</pre></div>
</div>
<p>The detailed description of the ASCII <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> output can be found in Section 3.4 of <a class="reference external" href="https://arxiv.org/abs/1912.08005">HepMC3 writeup</a>.
The first two line indicate the version of <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> (here 3.02.04) and the type of output, i.e. <code class="docutils literal notranslate"><span class="pre">Asciiv3</span></code> (<code class="docutils literal notranslate"><span class="pre">HepMC</span></code> supports also binary formats as output).
The block for each event starts with a line <code class="docutils literal notranslate"><span class="pre">E</span></code>, indicating the event number, the number of vertices and the number of particles. The line staring with <code class="docutils literal notranslate"><span class="pre">U</span></code> gives the adopted units for energy and distances. The lines starting with <code class="docutils literal notranslate"><span class="pre">P</span></code> are the particle lines: the first integer is the particle number in the list, the second the particle number of the parent particle, the third the <code class="docutils literal notranslate"><span class="pre">PDG</span></code> particle ID, then we have the 3-momentum, the nergy and the mass; finally the status, with <code class="docutils literal notranslate"><span class="pre">status==1</span></code> labelling <em>stable</em> particles entering leaving the interaction point and entering the detector. The lines starting with <code class="docutils literal notranslate"><span class="pre">A</span></code> indicate additional attributes: the can be per run, per event or per element of the listing. In this case they are used to provide helicity information for the two taus: the first number is the particle number, the second the name of the attribute, the rest the helicity information.</p>
<p>Q: What can be conidered <em>strange</em> in the above listing ?</p>
<div class="toggle admonition">
<p class="admonition-title">Suggested answer</p>
<p>A close-up look at the listing rasing two questions
1. The number of the second event is still 0. This is due to a bug in the <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> interface of <code class="docutils literal notranslate"><span class="pre">KKMCee</span></code>; it has no influence
in the following processing, since not really used.
2. The number of vertices does not seem to correspond to what found in the listing. The number of vertices, for example 4 in the first listing, correponds to the collision plus the decays one: the collision one is indicated by <code class="docutils literal notranslate"><span class="pre">V</span></code>, the other 3 are not indicated explicitely, but can be infered by looking at the particles having the same non-null parent ID: the decays of the Z boson (PDG id = 23), of Tau- (</p>
</div>
</div>
<p>The remaining output files from the run are found in the <code class="docutils literal notranslate"><span class="pre">KKMCee-&lt;date&gt;-&lt;time&gt;</span></code> directory. In particular the file <code class="docutils literal notranslate"><span class="pre">pro.output</span></code> contains at the end information about the process cross-section.</p>
<p>In this example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tail -37 KKMCee-&lt;date&gt;-&lt;time&gt;/pro.output
   *****************************
   ****   KKMCee   Finalize ****
   *****************************
********************************************************************************
*                                                                              *
*                   ****************************************                   *
*                   ******      KKMCee::Finalize      ******                   *
*                   ****************************************                   *
*   f_NevGen =      10000 =                          No. of generated events   *
*   XsPrimPb =       2700.8373   =                   Primary from Foam [pb]    *
*  FoamInteg =       1713.9085   =                   Crude from FOAM   [pb]    *
*         +- =    0.0015374453   =                   error                     *
*                   ****************************************                   *
*   &lt;WtMain&gt; =       0.5480549   =                   average WtMain            *
*         +- =    0.0014250983   =                   error abs.                *
*     XsMain =       1480.2071   =                   Xsection main [pb]        *
*         +- =    0.0070229434   =                   error absolute            *
*         +- =    0.0026002838   =                   error relative            *
*                   ********** More from WtMainMonit *******                   *
*      AveWt =       0.5480549   =                   average &lt;WtMain&gt;          *
*      ERela =    0.0026002838   =                   relative error            *
*      sigma =      0.38497968   =                   dispersion of WtMain      *
*   DB_WTmax =               4   =                   input WTmax               *
*      WtMax =       4.2012103   =                   maximum  WTmain           *
*      WtMin =               0   =                   mainimum WTmain           *
*      AvUnd =               0   =                   underflow                 *
*      AvOve =   5.5091102e-06   =                   overflow                  *
* AvOve/&lt;Wt&gt; =   1.0052114e-05   =                   relative: AvOve/AveWt     *
*       Ntot =           72977   =                   Ntot primary events       *
*       Nacc =           10000   =                   accepted events           *
*  Nacc/Ntot =      0.13702948   =                   acceptance rate           *
*       Nneg =               0   =                   WT&lt;0 events               *
*       Nove =               2   =                   WT&gt;WTmax events           *
*  Nove/Ntot =   2.7405895e-05   =                   Nove/Ntot                 *
*       Nzer =            1201   =                   WT=0 events               *
*                                                                              *
********************************************************************************
</pre></div>
</div>
<p>i.e the total ditau cross-section at 91.2 GeV from <code class="docutils literal notranslate"><span class="pre">KKMCee</span></code> is 1480.2 +- 7.0 pb .</p>
</section>
<section id="hepmc-to-edm4hep-conversion">
<h4><span class="section-number">2.1.4.1.2. </span><code class="docutils literal notranslate"><span class="pre">HepMC</span></code> to <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> conversion<a class="headerlink" href="#hepmc-to-edm4hep-conversion" title="Link to this heading"></a></h4>
<p>In order to get the events in <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> format, we will use <code class="docutils literal notranslate"><span class="pre">Gaudi</span></code> and the tools available in <a class="reference external" href="https://github.com/key4hep/k4FWCore">k4FWCore</a> and <a class="reference external" href="https://github.com/HEP-FCC/k4Gen/">k4Gen</a>. We need a Gaudi steering file that reads the <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> file and writes out the <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> file.
A minimal version of such a steering code is available on the tutorial reference page:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">fccsw</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">cern</span><span class="o">.</span><span class="n">ch</span><span class="o">/</span><span class="n">tutorials</span><span class="o">/</span><span class="n">october2020</span><span class="o">/</span><span class="n">tutorial1</span><span class="o">/</span><span class="n">hepmc2edm</span><span class="o">.</span><span class="n">py</span> <span class="o">.</span>
</pre></div>
</div>
<p>Let’s see what it does: that is shown by the first line of the help function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ k4run hepmc2edm.py -h
 --&gt;  GenAlg  --&gt;  HepMCToEDMConverter  --&gt;  out
...
</pre></div>
</div>
<section id="dissection-of-hepmc2edm-py">
<h5><span class="section-number">2.1.4.1.2.1. </span>Dissection of <code class="docutils literal notranslate"><span class="pre">hepmc2edm.py</span></code><a class="headerlink" href="#dissection-of-hepmc2edm-py" title="Link to this heading"></a></h5>
<div class="toggle admonition">
<p class="admonition-title">Expand</p>
<p>The tool that we need is <a class="reference external" href="https://github.com/HEP-FCC/k4Gen/blob/main/k4Gen/src/components/HepMCFileReader.h">HepMCFileReader</a>, which is a <code class="docutils literal notranslate"><span class="pre">GaudiTool</span></code>, not a <code class="docutils literal notranslate"><span class="pre">GaudiAlgorithm</span></code>, which is used as a signal provider (such as a Monte Carlo generator) within the <a class="reference external" href="https://github.com/HEP-FCC/k4Gen/blob/main/k4Gen/src/components/GenAlg.h">Generator Algorithm (GenAlg)</a>. This is done in this part of the code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Configurables</span> <span class="kn">import</span> <span class="n">HepMCFileReader</span>
<span class="n">hepmcreader</span> <span class="o">=</span> <span class="n">HepMCFileReader</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">Configurables</span> <span class="kn">import</span> <span class="n">GenAlg</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">GenAlg</span><span class="p">()</span>
<span class="n">reader</span><span class="o">.</span><span class="n">SignalProvider</span> <span class="o">=</span> <span class="n">hepmcreader</span>
<span class="n">reader</span><span class="o">.</span><span class="n">hepmc</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;hepmc&quot;</span>
<span class="n">ApplicationMgr</span><span class="p">()</span><span class="o">.</span><span class="n">TopAlg</span> <span class="o">+=</span> <span class="p">[</span><span class="n">reader</span><span class="p">]</span>
</pre></div>
</div>
<p>Then we convert the event from <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> to <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> with the <a class="reference external" href="https://github.com/HEP-FCC/k4Gen/blob/main/k4Gen/src/components/HepMCToEDMConverter.h">HepMCToEDMConverter</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Configurables</span> <span class="kn">import</span> <span class="n">HepMCToEDMConverter</span>
<span class="n">hepmc_converter</span> <span class="o">=</span> <span class="n">HepMCToEDMConverter</span><span class="p">()</span>
<span class="n">hepmc_converter</span><span class="o">.</span><span class="n">hepmc</span><span class="o">.</span><span class="n">Path</span><span class="o">=</span><span class="s2">&quot;hepmc&quot;</span>
<span class="n">hepmc_converter</span><span class="o">.</span><span class="n">GenParticles</span><span class="o">.</span><span class="n">Path</span> <span class="o">=</span> <span class="s2">&quot;GenParticles&quot;</span>
<span class="n">ApplicationMgr</span><span class="p">()</span><span class="o">.</span><span class="n">TopAlg</span> <span class="o">+=</span> <span class="p">[</span><span class="n">hepmc_converter</span><span class="p">]</span>
</pre></div>
</div>
<p>Finally we write out the converted events into a file with the <a class="reference external" href="https://github.com/key4hep/k4FWCore/blob/master/k4FWCore/components/PodioOutput.h">PodioOutput</a> algorithm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Configurables</span> <span class="kn">import</span> <span class="n">PodioOutput</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">PodioOutput</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;hepmc2edm_output.root&quot;</span><span class="p">)</span>
<span class="n">out</span><span class="o">.</span><span class="n">outputCommands</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;keep *&quot;</span><span class="p">]</span>
<span class="n">ApplicationMgr</span><span class="p">()</span><span class="o">.</span><span class="n">TopAlg</span> <span class="o">+=</span> <span class="p">[</span><span class="n">out</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
<section id="running-hepmc2edm-py">
<h5><span class="section-number">2.1.4.1.2.2. </span>Running <code class="docutils literal notranslate"><span class="pre">hepmc2edm.py</span></code><a class="headerlink" href="#running-hepmc2edm-py" title="Link to this heading"></a></h5>
<p>Among the <code class="docutils literal notranslate"><span class="pre">hepmc2edm</span></code> switches relevant for the purpose are those controling input an output files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ k4run hepmc2edm.py -h
...
  --GenAlg.HepMCFileReader.Filename [GENALG.HEPMCFILEREADER.FILENAME], --Filename.GenAlg.HepMCFileReader [GENALG.HEPMCFILEREADER.FILENAME]
                        Name of the HepMC file to read [HepMCFileReader]
...
  --out.filename [OUT.FILENAME], --filename.out [OUT.FILENAME]
                        Name of the file to create [PodioOutput]
...
</pre></div>
</div>
<p>We would like the output file to be called <code class="docutils literal notranslate"><span class="pre">kk_tautau_10000.e4h.root</span></code> . Which command should we use for that?</p>
<div class="toggle admonition">
<p class="admonition-title">Check answer</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>k4run<span class="w"> </span>hepmc2edm.py<span class="w"> </span>-n<span class="w"> </span><span class="m">10000</span><span class="w"> </span>--GenAlg.HepMCFileReader.Filename<span class="w"> </span>kk_tautau_10000.hepmc<span class="w"> </span>--out.filename<span class="w"> </span>kk_tautau_10000.e4h.root
</pre></div>
</div>
</div>
<p>Q: Can you explain why we need to pass the <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">10000</span></code> switch and how you could modify <code class="docutils literal notranslate"><span class="pre">hepmc2edm.py</span></code> to avoid that?</p>
<div class="toggle admonition">
<p class="admonition-title">Check answer</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">hepmc2edm.py</span></code> contains this piece of code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">Configurables</span> <span class="kn">import</span> <span class="n">ApplicationMgr</span>
<span class="n">ApplicationMgr</span><span class="p">(</span>
               <span class="n">EvtSel</span><span class="o">=</span><span class="s1">&#39;NONE&#39;</span><span class="p">,</span>
               <span class="n">EvtMax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
               <span class="n">OutputLevel</span><span class="o">=</span><span class="n">INFO</span><span class="p">,</span>
</pre></div>
</div>
<p>The setting <code class="docutils literal notranslate"><span class="pre">EvtMax=1</span></code> is overwritten by <code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">&lt;n_evts&gt;</span></code>. To avoid this one could set <code class="docutils literal notranslate"><span class="pre">EvtMax=10000</span></code> inside <code class="docutils literal notranslate"><span class="pre">hepmc2edm.py</span></code> (try!)</p>
</div>
<p>Note <em>en passant</em> that the <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> file is much smaller than the <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls -lt
total 43032
-rw-r--r-- 1 ganis vboxsf  3661630 Oct 18  2022 kk_tautau_10000.e4h.root
-rw-r--r-- 1 ganis vboxsf     1232 Oct 18  2022 hepmc2edm.py
drwxr-xr-x 1 ganis vboxsf      288 Oct 18 16:12 KKMCee-18Oct2022-161012
-rw-r--r-- 1 ganis vboxsf 19584017 Oct 18 16:12 kk_tautau_10000.hepmc
</pre></div>
</div>
<p>Q: Can you explain why?</p>
<div class="toggle admonition">
<p class="admonition-title">Check answer</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">kk_tautau_10000.e4h.root</span></code> is a <code class="docutils literal notranslate"><span class="pre">ROOT</span></code> file, which binary and compressed.</p>
</div>
</section>
</section>
</section>
<section id="generating-ditaus-with-pythia8">
<h3><span class="section-number">2.1.4.2. </span>Generating ditaus with Pythia8<a class="headerlink" href="#generating-ditaus-with-pythia8" title="Link to this heading"></a></h3>
<p>As explained in the dedicated <a class="reference internal" href="#pythia8">Pythia8 section</a>, to use <code class="docutils literal notranslate"><span class="pre">Pythia8</span></code> we need a configuration file. To generate ditau events we will use the file
<a class="reference external" href="https://github.com/HEP-FCC/FCC-config/blob/main/FCCee/Generator/Pythia8/p8_ee_Ztautau_ecm91.cmd">p8_ee_Ztautau_ecm91.cmd</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget https://raw.githubusercontent.com/HEP-FCC/FCC-config/main/FCCee/Generator/Pythia8/p8_ee_Ztautau_ecm91.cmd
</pre></div>
</div>
<p>Q: How will we run it? (hint: check specific section)</p>
<div class="toggle admonition">
<p class="admonition-title">Answer</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k4run</span> <span class="n">pythia</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span> <span class="o">--</span><span class="n">out</span><span class="o">.</span><span class="n">filename</span> <span class="n">p8_tautau_10000</span><span class="o">.</span><span class="n">d4h</span><span class="o">.</span><span class="n">root</span> <span class="o">--</span><span class="n">Pythia8</span><span class="o">.</span><span class="n">PythiaInterface</span><span class="o">.</span><span class="n">pythiacard</span> <span class="n">p8_ee_Ztautau_ecm91</span><span class="o">.</span><span class="n">cmd</span>
</pre></div>
</div>
</div>
<p>Running will take a few minutes. Among the last lines of the output there should be the total cross-section for the process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">*-------</span>  <span class="n">PYTHIA</span> <span class="n">Event</span> <span class="ow">and</span> <span class="n">Cross</span> <span class="n">Section</span> <span class="n">Statistics</span>  <span class="o">-------------------------------------------------------------*</span>
 <span class="o">|</span>                                                                                                                 <span class="o">|</span>
 <span class="o">|</span> <span class="n">Subprocess</span>                                    <span class="n">Code</span> <span class="o">|</span>            <span class="n">Number</span> <span class="n">of</span> <span class="n">events</span>       <span class="o">|</span>      <span class="n">sigma</span> <span class="o">+-</span> <span class="n">delta</span>    <span class="o">|</span>
 <span class="o">|</span>                                                    <span class="o">|</span>       <span class="n">Tried</span>   <span class="n">Selected</span>   <span class="n">Accepted</span> <span class="o">|</span>     <span class="p">(</span><span class="n">estimated</span><span class="p">)</span> <span class="p">(</span><span class="n">mb</span><span class="p">)</span>   <span class="o">|</span>
 <span class="o">|</span>                                                    <span class="o">|</span>                                   <span class="o">|</span>                        <span class="o">|</span>
 <span class="o">|-----------------------------------------------------------------------------------------------------------------|</span>
 <span class="o">|</span>                                                    <span class="o">|</span>                                   <span class="o">|</span>                        <span class="o">|</span>
 <span class="o">|</span> <span class="n">f</span> <span class="n">fbar</span> <span class="o">-&gt;</span> <span class="n">gamma</span><span class="o">*/</span><span class="n">Z0</span>                            <span class="mi">221</span> <span class="o">|</span>      <span class="mi">140682</span>      <span class="mi">10000</span>      <span class="mi">10000</span> <span class="o">|</span>   <span class="mf">1.458e-06</span>  <span class="mf">7.715e-09</span> <span class="o">|</span>
 <span class="o">|</span>                                                    <span class="o">|</span>                                   <span class="o">|</span>                        <span class="o">|</span>
 <span class="o">|</span> <span class="nb">sum</span>                                                <span class="o">|</span>      <span class="mi">140682</span>      <span class="mi">10000</span>      <span class="mi">10000</span> <span class="o">|</span>   <span class="mf">1.458e-06</span>  <span class="mf">7.715e-09</span> <span class="o">|</span>
 <span class="o">|</span>                                                                                                                 <span class="o">|</span>
 <span class="o">*-------</span>  <span class="n">End</span> <span class="n">PYTHIA</span> <span class="n">Event</span> <span class="ow">and</span> <span class="n">Cross</span> <span class="n">Section</span> <span class="n">Statistics</span> <span class="o">----------------------------------------------------------*</span>
</pre></div>
</div>
<p>i.e. 1458.0 +- 7.7 pb.</p>
<p>Q: How the cross-sections compare?</p>
<div class="toggle admonition">
<p class="admonition-title">Answer</p>
<p>The differences of teh corss-section calculated by <code class="docutils literal notranslate"><span class="pre">KKMCee</span></code> and <code class="docutils literal notranslate"><span class="pre">Pythia8</span></code> is (1480.2 - 1458.0) pb = 22.2 pb ; the errors have a statistical and systematic component. Assuming half and half for statistical and systematics, and the systematics fully correlated, the error on the difference is about 8.5 pb, i.e. the two calculatons differ by 2.6 standard deviations. What would you check first?</p>
</div>
</section>
<section id="generating-ditaus-with-whizard">
<h3><span class="section-number">2.1.4.3. </span>Generating ditaus with Whizard<a class="headerlink" href="#generating-ditaus-with-whizard" title="Link to this heading"></a></h3>
<p>As explained in the dedicated <a class="reference internal" href="#whizard">Whizard section</a>, to use <code class="docutils literal notranslate"><span class="pre">whizard</span></code> we need a <code class="docutils literal notranslate"><span class="pre">Sindarin</span></code> configuration file. To generate ditau events we will use the file
<a class="reference external" href="http://fccsw.web.cern.ch/tutorials/october2020/tutorial1/Z_tautau.sin">Z_tautau.sin</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget http://fccsw.web.cern.ch/tutorials/october2020/tutorial1/Z_tautau.sin
</pre></div>
</div>
<p>and run it in a dedicate directory to not pollute the working one withe the many files produced:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mkdir -p whizard/tautau; cd whizard/tautau;
$ whizard ../../Z_tautau.sin
</pre></div>
</div>
<p>The output created by <code class="docutils literal notranslate"><span class="pre">whizard</span></code> is <code class="docutils literal notranslate"><span class="pre">LHEf</span></code> (Les Houches Event format); this is because the curent build does not support writing <code class="docutils literal notranslate"><span class="pre">HepMC</span></code>; this may change in the future.</p>
<p>Exercise: look at produced <code class="docutils literal notranslate"><span class="pre">LHEf</span></code> file <code class="docutils literal notranslate"><span class="pre">z_tautau.lhe</span></code>: what di we notice?</p>
<div class="toggle admonition">
<p class="admonition-title">Answer</p>
<p>The taus are not decayed. Investigate if a Sindarin option to decay taus exists.</p>
</div>
<p>The first lines of the <code class="docutils literal notranslate"><span class="pre">LHEf</span></code> file give the total cross-section: 1502 +- 2 pb, which seems dfinetly higher than the othesr.</p>
<section id="lhef-to-edm4hep-conversion">
<h4><span class="section-number">2.1.4.3.1. </span><code class="docutils literal notranslate"><span class="pre">LHEf</span></code> to <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> conversion<a class="headerlink" href="#lhef-to-edm4hep-conversion" title="Link to this heading"></a></h4>
<p>In order to get the events in <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> format, we eploit the fact that <code class="docutils literal notranslate"><span class="pre">Pythia</span></code> provides <code class="docutils literal notranslate"><span class="pre">LHEf</span></code> reader functionality. To activate that we will use <code class="docutils literal notranslate"><span class="pre">Gaudi</span></code> and special <code class="docutils literal notranslate"><span class="pre">.cmd</span></code> file the consider the input <code class="docutils literal notranslate"><span class="pre">LHEf</span></code> input file as a <code class="docutils literal notranslate"><span class="pre">Beam</span></code>. This special <code class="docutils literal notranslate"><span class="pre">.cmd</span></code> is called <code class="docutils literal notranslate"><span class="pre">Pythia_LHEinput.cmd</span></code> and it is available under the directory pointed by <code class="docutils literal notranslate"><span class="pre">$K4GEN</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>S cp -rp $K4GEN/Pythia_LHEinput.cmd
</pre></div>
</div>
<p>Please note the lines</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! 4) Read-in Les Houches Event file - alternative beam and process selection.
Beams:frameType = 4                      ! read info from a LHEF
Beams:LHEF = Generation/data/events.lhe ! the LHEF to read from
</pre></div>
</div>
<p>This file needs to be edited to enter the exact locaton of the input file (it could also be a symlink to avoid always editng the file.</p>
<p>As steering we will use the file <a class="reference external" href="http://fccsw.web.cern.ch/tutorials/october2020/tutorial1/lhe2edm.py">lhe2edm.py</a> which run the following sequence:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ wget http://fccsw.web.cern.ch/tutorials/october2020/tutorial1/lhe2edm.py
$ k4run lhe2edm.py -h
 --&gt;  Pythia8 --&gt;  HepMCToEDMConverter --&gt;  HepMCFileWriter --&gt;  StableParticles --&gt;  out
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">HepMCFileWriter</span></code> step is redundant and only serves at converting also in <code class="docutils literal notranslate"><span class="pre">HepMC</span></code> for controls.
The conversion is run by the usual comand:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ k4run lhe2edm.py -n 10000 --out.filename wz_tautau_10000.e4h.root --HepMCFileWriter.Filename wz_tautau_10000.hepmc 
</pre></div>
</div>
</section>
</section>
<section id="looking-at-the-produced-files-the-mcparticle-class">
<h3><span class="section-number">2.1.4.4. </span>Looking at the produced files: the MCParticle class<a class="headerlink" href="#looking-at-the-produced-files-the-mcparticle-class" title="Link to this heading"></a></h3>
<p>Despite being ROOT files, the <code class="docutils literal notranslate"><span class="pre">EDM4hep</span></code> files are not easily usable, beaue they contain information in EDM4hep classes.
A good practie is to use some helper function available in FCAnalyses to create <code class="docutils literal notranslate"><span class="pre">flat</span></code> ntuple, much more readable.</p>
<section id="creating-flat-ntuples-with-fccanalyses">
<h4><span class="section-number">2.1.4.4.1. </span>Creating flat ntuples with FCCAnalyses<a class="headerlink" href="#creating-flat-ntuples-with-fccanalyses" title="Link to this heading"></a></h4>
<p>To create flat ntuples using FCCAnalyses we need a <code class="docutils literal notranslate"><span class="pre">Python</span></code> script to be feed into the framework.
An example is available in <a class="reference external" href="http://fccsw.web.cern.ch/tutorials/october2020/tutorial1/make_flat.py">make_flat.py</a>.</p>
<p>You should have a lok and try to understand what it does. It adds a few event varialbe whihc would be useful to compare.</p>
<p>In order to run it with <code class="docutils literal notranslate"><span class="pre">FCCAnalyses</span></code> we have to call it like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fccanalysis</span> <span class="n">run</span> <span class="n">make_flat</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">test</span> <span class="o">--</span><span class="n">output</span> <span class="n">kk_tautau_10000</span><span class="o">.</span><span class="n">flat</span><span class="o">.</span><span class="n">root</span>
</pre></div>
</div>
<p>and the same the other files.</p>
<p>Exercise: add a variable <code class="docutils literal notranslate"><span class="pre">invmass</span></code> with the invariant mass of the two taus.</p>
<div class="toggle admonition">
<p class="admonition-title">Hint</p>
<p>Look at the the <code class="docutils literal notranslate"><span class="pre">scalarProdNorm</span></code>.</p>
</div>
</section>
<section id="comparing-distributions">
<h4><span class="section-number">2.1.4.4.2. </span>Comparing distributions<a class="headerlink" href="#comparing-distributions" title="Link to this heading"></a></h4>
<p>This is the final exercise: write a <code class="docutils literal notranslate"><span class="pre">ROOT</span></code> macro, in <code class="docutils literal notranslate"><span class="pre">Python</span></code> or <code class="docutils literal notranslate"><span class="pre">C++</span></code>, to compare the global event variables <code class="docutils literal notranslate"><span class="pre">acol</span></code>, <code class="docutils literal notranslate"><span class="pre">n_charged</span></code>
and <code class="docutils literal notranslate"><span class="pre">cthetauminus</span></code>, and perhaps also <code class="docutils literal notranslate"><span class="pre">invmass</span></code>.</p>
<div class="toggle admonition">
<p class="admonition-title">Hint</p>
<p>Look at the <code class="docutils literal notranslate"><span class="pre">ROOT</span></code> tutorials for <code class="docutils literal notranslate"><span class="pre">RDataFrame</span></code>, <code class="docutils literal notranslate"><span class="pre">TTree</span></code> and <code class="docutils literal notranslate"><span class="pre">Hist</span></code>.</p>
</div>
<p>What can you say from the comparison?</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="README.html" class="btn btn-neutral float-left" title="2. Generators, Fast Simulation and Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="k4simdelphes/doc/starterkit/FccFastSimDelphes/Readme.html" class="btn btn-neutral float-right" title="2.2. FCC: Getting started with simulating events in Delphes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, CERN.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: cern2022
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../main/index.html">main</a></dd>
      <dd><a href="../../bnl2023/index.html">bnl2023</a></dd>
      <dd><a href="FccFastSimGeneration.html">cern2022</a></dd>
      <dd><a href="../../mit2024/index.html">mit2024</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>